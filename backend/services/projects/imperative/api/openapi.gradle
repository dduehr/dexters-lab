openApiGenerate {
    generatorName = "spring"

    inputSpec = "$rootDir/backend/services/projects/openapi.yaml".toString()
    outputDir = "$buildDir/generated/sources/openapi".toString()

    apiPackage = "com.example.lab.projects.controller"
    invokerPackage = "com.example.lab.projects.util"
    modelPackage = "com.example.lab.projects.dto"

    modelNameSuffix = "Dto"

    configOptions = [
            useSpringBoot3: "true",
            interfaceOnly: "false",
            delegatePattern: "true",
            useResponseEntity: "true",
            dateLibrary: "java8"
    ]

    validateSpec = true
    verbose = false
}
tasks.clean {
    doLast {
        println "$rootDir".toString()
    }
}

tasks.openApiGenerate {
    doLast {
       delete "$buildDir/generated/sources/openapi/src/main/java/com/example/lab/projects/util/OpenApiGeneratorApplication.java"
    }
}

sourceSets {
    main {
        java.srcDirs += "$buildDir/generated/sources/openapi/src/main/java".toString()
    }
}

compileJava.dependsOn 'openApiGenerate'